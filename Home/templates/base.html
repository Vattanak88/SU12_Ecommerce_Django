{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>{% block title %}Home{% endblock %}</title>
    <!-- In your Django template (e.g., base.html) -->
    <meta name="csrf-token" content="{{ csrf_token }}" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        margin: 0;
        padding: 0;
      }

      /* Navbar Styling */
      .navbar {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        padding: 20px 0;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }

      .navbar-brand h1 {
        margin: 0;
        font-size: 2rem;
        font-weight: 600;
      }

      .navbar-brand h1 span {
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
      }

      .nav-link {
        color: white !important;
        font-weight: 500;
        margin: 0 15px;
        transition: all 0.3s;
        position: relative;
      }

      .nav-link::after {
        content: "";
        position: absolute;
        bottom: -5px;
        left: 0;
        width: 0;
        height: 2px;
        background-color: #ffc107;
        transition: width 0.3s;
      }

      .nav-link:hover::after,
      .nav-link.active::after {
        width: 100%;
      }

      .nav-link:hover,
      .nav-link.active {
        color: #ffc107 !important;
      }

      .cart-icon {
        font-size: 20px;
        position: relative;
        color: white !important;
      }

      .cart-icon:hover {
        color: #ffc107 !important;
      }

      .cart-badge {
        position: absolute;
        top: -8px;
        left: 18px;
        background-color: #dc3545;
        color: white;
        font-size: 10px;
        padding: 3px 7px;
        border-radius: 50%;
        font-weight: 600;
      }

      .navbar-toggler {
        border-color: rgba(255, 255, 255, 0.5);
      }

      .navbar-toggler-icon {
        background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba(255, 255, 255, 0.8)' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e");
      }

      /* Hero Section */
      .hero-section {
        min-height: 600px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        padding: 80px 0;
        color: white;
      }

      .hero-content h1 {
        font-size: 3.5rem;
        font-weight: 600;
        margin-bottom: 20px;
      }

      .hero-year {
        position: absolute;
        font-size: 180px;
        font-weight: 600;
        color: rgba(255, 255, 255, 0.1);
        top: 50%;
        left: 50%;
        transform: translate(-60%, -60%);
        z-index: 0;
      }

      .hero-content {
        position: relative;
        z-index: 1;
      }

      .btn-shop-now {
        background-color: #000;
        color: white;
        padding: 12px 40px;
        font-weight: 500;
        border: none;
        border-radius: 5px;
        transition: all 0.3s;
      }

      .btn-shop-now:hover {
        background-color: #333;
        transform: translateY(-2px);
        color: white;
      }

      .hero-image {
        max-width: 100%;
        height: auto;
      }

      /* Features Section */
      .features-section {
        padding: 60px 0;
      }

      .feature-box {
        text-align: center;
        padding: 20px;
      }

      .feature-icon {
        font-size: 3rem;
        color: #667eea;
        margin-bottom: 20px;
      }

      .feature-box h4 {
        font-weight: 600;
        margin-bottom: 10px;
      }

      /* Categories Section */
      .categories-section {
        background-color: #f8f9fa;
        padding: 80px 0;
      }

      .section-title {
        font-size: 2.5rem;
        font-weight: 600;
        text-align: center;
        margin-bottom: 50px;
      }

      .category-card {
        border: none;
        border-radius: 10px;
        overflow: hidden;
        transition: all 0.3s;
        cursor: pointer;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }

      .category-card:hover {
        transform: translateY(-10px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
      }

      .category-card img {
        height: 250px;
        object-fit: cover;
        width: 100%;
      }

      .category-card .card-body {
        padding: 25px;
      }

      /* Products Section */
      .products-section {
        padding: 80px 0;
      }

      .product-card {
        border: 1px solid #e5e7eb;
        border-radius: 10px;
        overflow: hidden;
        transition: all 0.3s;
        height: 100%;
      }

      .product-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
      }

      .product-card img {
        height: 280px;
        object-fit: cover;
        width: 100%;
      }

      .sale-badge {
        position: absolute;
        top: 10px;
        right: 10px;
        background-color: #dc3545;
        color: white;
        padding: 5px 12px;
        border-radius: 5px;
        font-size: 0.85rem;
        font-weight: 600;
      }

      .product-rating {
        color: #ffc107;
        margin-bottom: 10px;
      }

      .product-price {
        font-size: 1.5rem;
        color: #667eea;
        font-weight: 600;
      }

      .old-price {
        text-decoration: line-through;
        color: #9ca3af;
        font-size: 1.1rem;
        margin-left: 10px;
      }

      .btn-add-cart {
        background-color: #667eea;
        color: white;
        border: none;
        padding: 10px 0;
        width: 100%;
        border-radius: 5px;
        font-weight: 500;
        transition: all 0.3s;
      }

      .btn-add-cart:hover {
        background-color: #5568d3;
      }

      /* Newsletter Section */
      .newsletter-section {
        background-color: #667eea;
        color: white;
        padding: 60px 0;
      }

      .newsletter-section h3 {
        font-size: 2rem;
        font-weight: 600;
        margin-bottom: 15px;
      }

      .newsletter-input {
        padding: 12px 20px;
        border: none;
        border-radius: 5px 0 0 5px;
      }

      .btn-subscribe {
        background-color: #ffc107;
        color: #000;
        border: none;
        padding: 12px 30px;
        font-weight: 600;
        border-radius: 0 5px 5px 0;
        transition: all 0.3s;
      }

      .btn-subscribe:hover {
        background-color: #ffb300;
      }

      /* Footer */
      footer {
        background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
        color: white;
        padding: 60px 0 20px;
        margin-top: 80px;
      }

      footer h3 {
        font-size: 1.2rem;
        font-weight: 600;
        margin-bottom: 25px;
        color: #ffc107;
        position: relative;
        padding-bottom: 10px;
      }

      footer h3::after {
        content: "";
        position: absolute;
        bottom: 0;
        left: 0;
        width: 40px;
        height: 2px;
        background-color: #ffc107;
      }

      footer a {
        color: #d1d5db;
        text-decoration: none;
        transition: all 0.3s;
        display: inline-block;
      }

      footer a:hover {
        color: #ffc107;
        transform: translateX(5px);
      }

      footer .brand h1 {
        margin-bottom: 15px;
        font-size: 2.5rem;
      }

      footer .brand h1 span {
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
      }

      footer p {
        line-height: 1.8;
        color: #d1d5db;
      }

      footer i {
        color: #667eea;
        transition: color 0.3s;
      }

      footer a:hover i {
        color: #ffc107;
      }

      .social-links {
        margin-top: 20px;
      }

      .social-links a {
        margin-right: 15px;
        font-size: 1.5rem;
        width: 40px;
        height: 40px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        background-color: rgba(102, 126, 234, 0.2);
        border-radius: 50%;
        transition: all 0.3s;
      }

      .social-links a:hover {
        background-color: #667eea;
        transform: translateY(-3px);
        color: white;
      }

      footer hr {
        border-color: rgba(255, 255, 255, 0.1);
        margin: 40px 0 20px;
      }

      .footer-bottom {
        padding: 20px 0;
        background-color: rgba(0, 0, 0, 0.2);
      }

      @media (max-width: 768px) {
        .hero-content h1 {
          font-size: 2.5rem;
        }

        .hero-year {
          font-size: 120px;
        }

        .section-title {
          font-size: 2rem;
        }
      }
    </style>

    

    {% if title == 'about' %} 
     
    
    <!-- Google Fonts - Poppins -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary: #4361ee;
            --secondary: #3f37c9;
            --success: #4cc9f0;
            --dark: #2b2d42;
            --light: #f8f9fa;
            --gray: #6c757d;
            --accent: #f72585;
        }

      

        .hero-section {
            padding: 120px 0 80px;
            position: relative;
            overflow: hidden;
        }

        .hero-section::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 300"><path d="M0,100 C200,300 800,0 1000,100 L1000,300 L0,300 Z" fill="%234361ee20"/></svg>') no-repeat bottom;
            background-size: cover;
        }

        .section-title {
            font-weight: 700;
            font-size: 2.8rem;
            position: relative;
            display: inline-block;
            color: var(--primary);
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: -12px;
            left: 0;
            width: 70px;
            height: 5px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            border-radius: 3px;
        }

        .about-img {
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 20px 50px rgba(67, 97, 238, 0.2);
            transition: all 0.4s ease;
        }

        .about-img:hover {
            transform: translateY(-10px);
            box-shadow: 0 30px 70px rgba(67, 97, 238, 0.3);
        }

        .feature-card {
            background: white;
            padding: 40px 30px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 15px 35px rgba(67, 97, 238, 0.1);
            transition: all 0.4s ease;
            height: 100%;
        }

        .feature-card:hover {
            transform: translateY(-15px);
            box-shadow: 0 25px 50px rgba(67, 97, 238, 0.2);
        }

        .feature-icon {
            width: 90px;
            height: 90px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 25px;
            font-size: 2.2rem;
            color: white;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
        }

        .team-card {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 15px 40px rgba(0,0,0,0.1);
            transition: all 0.4s ease;
        }

        .team-card:hover {
            transform: translateY(-10px);
        }

        .team-img {
            height: 280px;
            overflow: hidden;
        }

        .team-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: all 0.5s ease;
        }

        .team-card:hover .team-img img {
            transform: scale(1.1);
        }

        .team-info {
            padding: 25px;
            text-align: center;
        }

        .team-info h5 {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .team-info p {
            color: var(--primary);
            font-weight: 500;
            margin-bottom: 15px;
        }

        .social-team a {
            display: inline-flex;
            width: 38px;
            height: 38px;
            border-radius: 50%;
            background: var(--light);
            color: var(--primary);
            align-items: center;
            justify-content: center;
            margin: 0 5px;
            transition: all 0.3s ease;
        }

        .social-team a:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-3px);
        }

        .stats-section {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 80px 0;
            margin: 80px 0;
            border-radius: 30px;
            position: relative;
            overflow: hidden;
        }

        .stats-section::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" opacity="0.1"><circle cx="20" cy="20" r="10"/><circle cx="80" cy="30" r="15"/><circle cx="50" cy="70" r="12"/></svg>');
        }

        .stat-number {
            font-size: 3.5rem;
            font-weight: 700;
            display: block;
        }

        .timeline {
            position: relative;
            padding: 40px 0;
        }

        .timeline::before {
            content: '';
            position: absolute;
            top: 0;
            bottom: 0;
            left: 50%;
            width: 4px;
            background: linear-gradient(to bottom, var(--primary), var(--secondary));
            border-radius: 2px;
        }

        .timeline-item {
            margin-bottom: 50px;
            position: relative;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 20px;
            height: 20px;
            background: white;
            border: 5px solid var(--primary);
            border-radius: 50%;
            z-index: 1;
        }

        .timeline-content {
            width: 45%;
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .timeline-content.left {
            margin-right: auto;
            margin-left: 5%;
        }

        .timeline-content.right {
            margin-left: auto;
            margin-right: 5%;
        }

        @media (max-width: 992px) {
            .timeline::before {
                left: 30px;
            }
            
            .timeline-item::before {
                left: 30px;
                transform: translateX(-50%);
            }
            
            .timeline-content {
                width: calc(100% - 80px);
                margin-left: 80px !important;
            }
            
            .timeline-content.left,
            .timeline-content.right {
                margin-right: 0;
            }
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border: none;
            padding: 12px 30px;
            border-radius: 50px;
            font-weight: 600;
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(67, 97, 238, 0.4);
        }
    </style>
    
    {%endif%}

    {%if title == 'Contact'%}
        <!-- Bootstrap 5 CSS -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
        
        <!-- Font Awesome for Icons -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
        
        <!-- Google Fonts -->
        <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
        
        <style>
            :root {
                --primary: #4361ee;
                --secondary: #3f37c9;
                --success: #4cc9f0;
                --dark: #2b2d42;
                --light: #f8f9fa;
                --gray: #6c757d;
            }

            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                font-family: 'Poppins', sans-serif;
                background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
                min-height: 100vh;
                color: var(--dark);
            }

            .contact-container {
                padding: 60px 0;
            }

            .section-title {
                position: relative;
                display: inline-block;
                font-weight: 700;
                font-size: 2.5rem;
                margin-bottom: 50px;
                color: var(--primary);
            }

            .section-title::after {
                content: '';
                position: absolute;
                bottom: -10px;
                left: 0;
                width: 60px;
                height: 4px;
                background: var(--secondary);
                border-radius: 2px;
            }

            .contact-card {
                background: white;
                border-radius: 20px;
                overflow: hidden;
                box-shadow: 0 20px 40px rgba(67, 97, 238, 0.15);
                transition: all 0.3s ease;
                margin-bottom: 30px;
            }

            .contact-card:hover {
                transform: translateY(-10px);
                box-shadow: 0 30px 60px rgba(67, 97, 238, 0.25);
            }

            .contact-icon {
                width: 80px;
                height: 80px;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                margin: 0 auto 20px;
                font-size: 2rem;
                color: white;
            }

            .icon-location { background: linear-gradient(135deg, var(--primary), var(--secondary)); }
            .icon-phone { background: linear-gradient(135deg, #06d6a0, #1b9c85); }
            .icon-email { background: linear-gradient(135deg, #f72585, #b5179e); }
            .icon-time { background: linear-gradient(135deg, #ff6b6b, #ee5a52); }

            .contact-info h5 {
                font-weight: 600;
                margin-bottom: 10px;
                color: var(--dark);
            }

            .contact-info p {
                color: var(--gray);
                margin-bottom: 0;
            }

            .form-control, .form-select {
                border-radius: 12px;
                padding: 12px 16px;
                border: 2px solid #e9ecef;
                transition: all 0.3s ease;
                font-size: 1rem;
            }

            .form-control:focus, .form-select:focus {
                border-color: var(--primary);
                box-shadow: 0 0 0 0.2rem rgba(67, 97, 238, 0.15);
            }

            .form-label {
                font-weight: 500;
                color: var(--dark);
                margin-bottom: 8px;
            }

            .btn-submit {
                background: linear-gradient(135deg, var(--primary), var(--secondary));
                color: white;
                border: none;
                padding: 14px 32px;
                border-radius: 12px;
                font-weight: 600;
                font-size: 1.1rem;
                transition: all 0.3s ease;
                position: relative;
                overflow: hidden;
            }

            .btn-submit:hover {
                transform: translateY(-3px);
                box-shadow: 0 10px 20px rgba(67, 97, 238, 0.3);
            }

            .btn-submit:active {
                transform: translateY(-1px);
            }

            .alert-success {
                border-radius: 12px;
                padding: 16px;
                margin-top: 20px;
                display: none;
            }

            .map-container {
                border-radius: 20px;
                overflow: hidden;
                box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
                height: 400px;
                margin-top: 40px;
            }

            .social-links {
                margin-top: 30px;
            }

            .social-links a {
                display: inline-flex;
                align-items: center;
                justify-content: center;
                width: 50px;
                height: 50px;
                border-radius: 50%;
                margin: 0 10px;
                font-size: 1.3rem;
                transition: all 0.3s ease;
                color: white;
            }

            .social-links .fb { background: #1877f2; }
            .social-links .tw { background: #1da1f2; }
            .social-links .ig { background: linear-gradient(45deg, #f09433 0%, #e6683c 25%, #dc2743 50%, #cc2366 75%, #bc1888 100%); }
            .social-links .li { background: #0077b5; }

            .social-links a:hover {
                transform: translateY(-5px);
                box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
            }

            @media (max-width: 768px) {
                .section-title {
                    font-size: 2rem;
                }
                
                .contact-container {
                    padding: 40px 0;
                }
            }
        </style>
    {%endif%}
  </head>
  <body>
    <div>
      <div class="m-0 p-0" id="app">
        <nav class="navbar navbar-expand-lg sticky-top">
          <div class="container">
            <a href="{% url 'index'%}" class="navbar-brand text-decoration-none">
              <h1>SU1.2 - Ecommerce</h1>
            </a>

            <button
              class="navbar-toggler"
              type="button"
              data-bs-toggle="collapse"
              data-bs-target="#navbarNav"
            >
              <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarNav">
              <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
                <li class="nav-item">
                              <a class="nav-link {% if title == 'Index' %} active text-danger{% endif %}" href="{% url 'index' %}">Home</a>
                          </li>
                          <li class="nav-item">
                              <a class="nav-link {% if title == 'Shop' %} active   text-danger{% endif %}" href="{% url 'shop' %}">Shopping</a>
                          </li>
                          <li class="nav-item">
                              <a class="nav-link {% if title == 'About' %} active   text-danger{% endif %}" href="{% url 'about' %}">About</a>
                          </li>
                          <li class="nav-item">
                              <a class="nav-link {% if title == 'Contact' %} active   text-danger{% endif %}" href="{% url 'contact' %}">Contact</a>
                          </li>
              </ul>
              <div class="d-flex ms-3">
                <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link {% if title == 'Cart' %} active text-decoration-underline text-primary{% endif %}
                                            position-relative
                                    "
                                     style="font-size:20px;"
                                     href="{% url 'cart' %} ">
                                        <i class="fa-solid fa-cart-plus"></i>
                                        <p class="position-absolute badge rounded-pill bg-danger text-white" style="font-size:9px;top:3px;left:20px;">
                                            [[ cart_qty ]]
                                        </p>
                                  </a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </nav>

        <!-- content -->
            {% block content %}{% endblock %}
        <!-- end of content -->
 

        <!-- Footer -->
        <footer id="contact">
          <div class="container">
            <div class="row">
              <div class="col-md-4 mb-4">
                <div class="brand">
                  <h1>SU1.2 - Ecommerce</h1>
                  <p class="text-muted">
                    We provide quality products at affordable prices. Shop with
                    confidence and enjoy great deals every day.
                  </p>
                </div>
              </div>

              <div class="col-md-3 mb-4">
                <h3>Shopping & Categories</h3>
                <p class="mb-2">
                  <a href="#"> 
                    <span class="ms-2">Glasses</span>
                  </a>
                </p>
                <p class="mb-2">
                  <a href="#"> 
                    <span class="ms-2">Shoes</span>
                  </a>
                </p>
                <p class="mb-2">
                  <a href="#"> 
                    <span class="ms-2">Watches</span>
                  </a>
                </p>
                <p class="mb-2">
                  <a href="#"> 
                    <span class="ms-2">T-shirts</span>
                  </a>
                </p>
                <p class="mb-2">
                  <a href="#"> 
                    <span class="ms-2">Headsets</span>
                  </a>
                </p>
              </div>

              <div class="col-md-2 mb-4">
                <h3>Quick Links</h3>
                <p class="mb-2">
                  <a href="{% url 'index' %}"> 
                    <span class="ms-2">Home</span>
                  </a>
                </p>
                <p class="mb-2">
                  <a href="{% url 'shop' %}"> 
                    <span class="ms-2">Shopping</span>
                  </a>
                </p>
                <p class="mb-2">
                  <a href="{% url 'about' %}"> 
                    <span class="ms-2">About</span>
                  </a>
                </p>
                <p class="mb-2">
                  <a href="{% url 'contact' %}"> 
                    <span class="ms-2">Contact</span>
                  </a>
                </p>
              </div>

              <div class="col-md-3 mb-4">
                <h3>Contact Us</h3>
                <p>
                  <i class="fa-solid fa-phone-volume"></i>
                  <span class="ms-2">+855 xxx xxx xxx</span>
                </p>
                <p>
                  <i class="fa-solid fa-truck-fast"></i>
                  <span class="ms-2">email@example.com</span>
                </p> 
                <p>
                  <i class="fa-brands fa-facebook"></i>
                  <span class="ms-2">SU1.2 - Ecommerce</span>
                </p> 
                <p>
                  <i class="fa-brands fa-telegram"></i>
                  <span class="ms-2">@user234</span>
                </p> 
              </div>
            </div>

            <hr />

            <div class="text-center">
              <p class="mb-0">&copy; 2025 SU1.2 - Ecommerce. All rights reserved.</p>
            </div>
          </div>
        </footer>

        
      </div>
    </div>

    

    {%if title == 'Contact'%}
    <!-- Bootstrap 5 JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Custom JavaScript -->
    <script>
        document.getElementById('contactForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Show loading state
            const submitBtn = this.querySelector('.btn-submit');
            const submitText = submitBtn.querySelector('.submit-text');
            const spinner = submitBtn.querySelector('.spinner-border');
            
            submitText.classList.add('d-none');
            spinner.classList.remove('d-none');
            submitBtn.disabled = true;
            
            // Simulate form submission
            setTimeout(() => {
                // Hide loading state
                submitText.classList.remove('d-none');
                spinner.classList.add('d-none');
                submitBtn.disabled = false;
                
                // Show success message
                document.getElementById('successAlert').style.display = 'block';
                
                // Reset form
                this.reset();
                
                // Hide success message after 5 seconds
                setTimeout(() => {
                    document.getElementById('successAlert').style.display = 'none';
                }, 5000);
            }, 2000);
        });

        // Add smooth scrolling
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                document.querySelector(this.getAttribute('href')).scrollIntoView({
                    behavior: 'smooth'
                });
            });
        });
    </script>
    {%endif%}
    {% if tittle == 'about'%}
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // Smooth scrolling
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                document.querySelector(this.getAttribute('href')).scrollIntoView({
                    behavior: 'smooth'
                });
            });
        });

        // Counter animation for stats
        const counters = document.querySelectorAll('.stat-number');
        const speed = 200;

        const animateCounters = () => {
            counters.forEach(counter => {
                const target = counter.innerText.replace(/[^0-9]/g, '');
                const suffix = counter.innerText.replace(/[0-9]/g, '');
                const count = +target;
                const inc = count / speed;

                let current = 0;
                const timer = setInterval(() => {
                    current += inc;
                    if (current > count) {
                        counter.innerText = target + suffix;
                        clearInterval(timer);
                    } else {
                        counter.innerText = Math.ceil(current) + suffix;
                    }
                }, 15);
            });
        };

        // Trigger counter when in viewport
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    animateCounters();
                    observer.unobserve(entry.target);
                }
            });
        });

        observer.observe(document.querySelector('.stats-section'));
    </script>
    {%endif %}

    <!--- bootstrap cdn  js -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"></script>

    <!-- sweetalert -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <!-- fontawesome -->
    <script
      src="https://kit.fontawesome.com/f30f0231eb.js"
      crossorigin="anonymous"
    ></script>
    <!-- Swiper JS -->
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

    <!-- vue js -->
    <script type="module">
      import { createApp } from 'https://unpkg.com/vue@3/dist/vue.esm-browser.js';

      // GET CSRF TOKEN BEFORE ANYTHING ELSE
      function getCsrfTokenFromMeta() {
          return document.querySelector('meta[name="csrf-token"]').getAttribute('content');
      }
      const csrftoken = getCsrfTokenFromMeta();

      const App = {
          delimiters: ['[[', ']]'],
              data() {
                  return {
                      Products: [],
                      title: 'Shop',

                      // add to cart
                      cart_list : [],
                      saved_cart_ids : [],
                      total_cart_count : 0,
                      total_cart_number  : [],
                      total_cart_check : [],
                      cart_item : [],
                      cart_list_detail : [],

                      // product detail
                      productDetail: {},

                      // variable
                      name : '',
                      description : '',
                      status : false,
                      price : 0,
                      discount_price : 0,
                      category : '',
                      image : '',
                      rate : 0,
                      qty:0,

                      // khmer rate per dollar
                      kh_rate : 4100,
                      delivery_fee : 0.1,

                      phoneNumber: '010 94 77 90',
                      email: 'sample@gmail.com',
                      fullName: 'Suong Sammarady',
                      address: 'takeo',
                      instructions: '',
                      currencyType: 'USD',  
                      buttonVisible : false,

                      payment_amount : 0,
                      current_type : '',

                      paymentData: null,
                      md5 : '',
                      orderLastId : 0,
                  };
              },
              computed: {
                  cart_qty() {
                      return this.total_cart_count;
                  },
                  totalAmount(){
                      let total = 0;
                      let totalPlusShip = 0;
                      const shippingFee = 0.010;

                      this.total_cart_number.forEach(item => {
                          if (item.status === true) {
                              let subTotal = (parseFloat(item.qty) || 0) * (parseFloat(item.price) || 0);
                              total += subTotal;
                          }
                      });

                      totalPlusShip = total + shippingFee;

                      return {
                          total: total,
                          total_usd: total.toLocaleString(),
                          total_kh: (Math.ceil(total * this.kh_rate / 100) * 100).toLocaleString(),
                          totalPlusShip: totalPlusShip, 
                          totalPlusShip_usd:  totalPlusShip.toFixed(2) ,
                          totalPlusShip_kh: (Math.ceil(totalPlusShip * this.kh_rate / 100) * 100) ,
                          shipping: shippingFee
                      };

                  },
                  selectedProduct(){
                      let selected = false
                      selected = this.cart_list.filter(item => {
                          return item.status === true
                      })

                      console.log("helo",selected)
                  },
                  statusCart(){
                      this.buttonVisible = this.total_cart_number.some(item => item.status === true);

                      return  this.buttonVisible
                  },
                  getSelectedCartItems(){
                      return this.total_cart_number
                          .filter(item => item.status === true) // keep only items where status is true
                              .map(item => ({
                                  id : item.id,
                                  qty: item.qty,
                                  price: item.price,
                                  name: item.name,
                                  image : item.image,
                                  p_id : item.product_id
                          }));
                  }
              },
              methods: {
                  fetchProducts() {
                      // Construct the URL dynamically
                      let protocol = window.location.protocol;
                      let port = window.location.port;
                      let hostname = window.location.hostname;
                      let url = `${protocol}//${hostname}:${port}/fetchproducts`;

                      // Perform the fetch request
                      fetch('/fetchproducts')
                          .then(res => {
                              // Check if the response is successful
                              if (!res.ok) {
                                  throw new Error(`Failed to fetch products: ${res.statusText}`);
                              }
                              return res.json();
                          })
                          .then(data => {
                              // Check if the data is an array before attempting to use it
                              if (Array.isArray(data)) {
                                  if (data.length === 0) {
                                      console.log("No products available.");
                                  } else {
                                      this.Products = data;
                                  }
                              } else {
                                  console.error("Fetched data is not an array", data);
                              }
                          })
                          .catch(error => {
                              // Handle error and reset loading state
                              console.error("Error fetching products:", error);
                          });
                  },
                  addToCart(product) {

                      let find_index = this.cart_list.findIndex(obj => {
                          return obj.product_id === product.id
                      })

                      if( find_index > -1) {
                          this.cart_list[find_index].qty++
                      }
                      else {
                          let cart_product = {
                              status : false,
                              name : product.name,
                              price : product.price,
                              qty : 1,
                              image : product.image,
                              product_id : product.id
                          }

                          this.cart_list.push(cart_product)
                      }

                      console.log('Sending cart_list to server:', JSON.stringify(this.cart_list));

                      // Send the updated cart list to the backend
                      fetch('/addtocart/', {
                          headers: {
                              'X-CSRFToken': csrftoken,
                              'Content-Type': 'application/json'
                          },
                          method: 'POST',
                          body: JSON.stringify(this.cart_list) // Send cart data as JSON
                      })
                      .then(response => {
                          if (!response.ok) {
                              // Log the actual response body for debugging
                              return response.text().then(text => {
                                  console.error('Response status:', response.status, 'Body:', text);
                                  throw new Error(`HTTP ${response.status}: ${text}`);
                              });
                          }
                          return response.json(); // Parse the JSON response
                      })
                      .then(data => {
                          console.log('Cart data successfully sent to backend:', data);
                          this.cart_count();
                      })
                      .catch(error => {
                          console.error('There was an error with the fetch operation:', error);
                          Swal.fire({
                              position: "center",
                              icon: "error",
                              title: "Failed to add to cart",
                              text: error.message || 'Unknown error',
                              showConfirmButton: true
                          });
                      });

                      Swal.fire({
                        position: "center",
                        icon: "success",
                        title: "Your product has been added to cart",
                        showConfirmButton: false,
                        timer: 1000
                      });

                      this.cart_list = [];
                  },
                  cart_count(){
                      fetch('/cartcount')
                          .then(res => {
                              if (!res.ok) {
                                  console.error('Cart count error:', res.status, res.statusText);
                                  throw new Error(`Failed to fetch cart count: ${res.statusText}`);
                              }
                              return res.json();
                          })
                          .then(data => {
                              if (typeof data === 'number') {
                                  this.total_cart_count = data;
                              } else if (Array.isArray(data)) {
                                  this.total_cart_count = data.length;
                              } else {
                                  console.error('Cart count data format unexpected:', data);
                                  this.total_cart_count = 0;
                              }
                          })
                          .catch(error => {
                              console.error('Cart count fetch error:', error);
                              this.total_cart_count = 0;
                          });
                  },
                  total_cart() {
                      fetch('/total_cart')
                          .then(res => {
                              if (!res.ok) {
                                  console.error('Total cart error:', res.status, res.statusText);
                                  throw new Error(`Failed to fetch cart total: ${res.statusText}`);
                              }
                              return res.json();
                          })
                          .then(data => {
                              if (Array.isArray(data)) {
                                  this.total_cart_number = data;
                              } else {
                                  console.error('Total cart data format unexpected:', data);
                                  this.total_cart_number = [];
                              }
                          })
                          .catch(error => {
                              console.error('Total cart fetch error:', error);
                              this.total_cart_number = [];
                          });
                  },
                  delete_cart(id) {
                      const csrfToken = this.getCsrfToken();

                      fetch(`/cart/delete/${id}`,{
                          method: 'DELETE',
                          headers: {
                              'Content-Type': 'application/json',
                              'X-CSRFToken': csrfToken,
                          }
                      })
                          .then(res => {
                              if (!res.ok) {
                                  console.error('Delete cart error:', res.status, res.statusText);
                                  throw new Error(`Failed to delete cart item: ${res.statusText}`);
                              }
                              return res.json();
                          })
                          .then(data => {
                              console.log('Cart item deleted:', data);
                          })
                          .catch(error => {
                              console.error('Delete cart fetch error:', error);
                          });
                  },
                  getCsrfToken() {
                      return document.querySelector('meta[name="csrf-token"]').getAttribute('content');
                  },
                  removeCartElement(index){
                      (this.total_cart_number.length > 1) ?
                          this.total_cart_number.splice(index,1) :
                           setTimeout( () => {
                               window.location.reload()
                           },1500);
                  },
                  subQty(id,cart_qty){
                      let protocol = window.location.protocol;
                      let port = window.location.port;
                      let hostname = window.location.hostname;
                      let url = `${protocol}//${hostname}:${port}/cart/qty/sub/${id}`;
                      console.log(id);
                      const csrfToken = this.getCsrfToken();

                      fetch(`/cart/qty/sub/${id}`,{
                          method: 'PATCH',
                          headers: {
                              'Content-Type': 'application/json',
                              'X-CSRFToken': csrfToken,
                          },
                          body: JSON.stringify({ sub_qty : cart_qty }) ,
                          credentials: 'include'
                      }).then(
                          res => {
                              if (!res.ok) {
                                  throw new Error(`Failed to update products: ${res.statusText}`);
                              }
                              return res.json();
                          }
                      ).then(data => {
                          const item = this.total_cart_number.find(c => c.id === id);
                          if(item) item.qty = data.qty;
                          console.log(data);
                      });

                  },
                  addQty(id,cart_qty){
                      let protocol = window.location.protocol;
                      let port = window.location.port;
                      let hostname = window.location.hostname;
                      let url = `${protocol}//${hostname}:${port}/cart/qty/add/${id}`;
                      console.log(id);
                      const csrfToken = this.getCsrfToken();

                      fetch(`/cart/qty/add/${id}`,{
                          method: 'PATCH',
                          headers: {
                              'Content-Type': 'application/json',
                              'X-CSRFToken': csrfToken,  // Include the CSRF token in the header
                          },
                          body: JSON.stringify({ add_qty : cart_qty })  // Send data in the request body
                      }).then(
                          res => {
                              if (!res.ok) {
                                  throw new Error(`Failed to update products: ${res.statusText}`);
                              }
                              return res.json();
                          }
                      ).then(data => {
                          const item = this.total_cart_number.find(c => c.id === id);
                          if(item) item.qty = data.qty;
                          console.log(data);
                      });
                  },
                  deleteCart(id,index){
                      Swal.fire({
                        title: "Are you sure?",
                        text: "You won't be able to revert this!",
                        icon: "warning",
                        showCancelButton: true,
                        confirmButtonColor: "#3085d6",
                        cancelButtonColor: "#d33",
                        confirmButtonText: "Yes, remove it!"
                      }).then((result) => {
                        if (result.isConfirmed) {
                          Swal.fire({
                            title: "Removed!",
                            text: "Your file has been removed.",
                            icon: "success",
                              timer:1500
                          });
                          this.delete_cart(id);
                          this.removeCartElement(index);
                        }
                      });

                  },
                  checkedCart(id,cart_status){
                      const csrfToken = this.getCsrfToken();

                      fetch(`/cart/status/${id}`,{
                          method: 'PATCH',
                          headers: {
                              'Content-Type': 'application/json',
                              'X-CSRFToken': csrfToken,
                          },
                          body: JSON.stringify({ status: cart_status })
                      }).then(
                          res => {
                              if (!res.ok) {
                                  console.error('Check cart error:', res.status, res.statusText);
                                  throw new Error(`Failed to update cart status: ${res.statusText}`);
                              }
                              return res.json();
                          }
                      ).then(data => {
                          let item = this.total_cart_number.find(c => c.id === id)
                          if(item) {
                              item.status = data.status

                              let cart_id = new Set(JSON.parse(localStorage.getItem('cart_id')) || []);

                              for (let item of this.total_cart_number) {
                                  if (item.status === true) {
                                      cart_id.add(item.id);
                                  }else {
                                      cart_id.delete(item.id);
                                  }
                              }

                              localStorage.setItem('cart_id', JSON.stringify([...cart_id]));
                              console.log("cart status updated",data);
                          }
                      })
                      .catch(error => {
                          console.error('Check cart fetch error:', error);
                      });
                  },
                  product_detail(product) {
                      this.productDetail = product

                      console.log(this.productDetail)
                      this.name = this.productDetail.name
                      this.description = this.productDetail.description
                      this.category = this.productDetail.category
                      this.rate = this.productDetail.rate
                      this.image = this.productDetail.image
                      this.price = this.productDetail.price
                      this.discount_price = this.productDetail.discount_price
                  },
                  test(){
                      this.addToCart(this.productDetail)
                  },

                  cart_detail(){
                      fetch('/cart/cart_detail')
                          .then(res => {
                              if (!res.ok) {
                                  console.error('Cart detail error:', res.status, res.statusText);
                                  throw new Error('Failed to fetch cart details');
                              }
                              return res.json();
                          }).then(data => {
                              if (Array.isArray(data)) {
                                  this.saved_cart_ids = data.filter(item => item.status === true).map(item => item.id);
                              } else {
                                  console.error('Cart detail data is not an array:', data);
                                  this.saved_cart_ids = [];
                              }
                          })
                          .catch(error => {
                              console.error('Cart detail fetch error:', error);
                              this.saved_cart_ids = [];
                          });
                  },
                  order_detail(){
                      fetch('/cart/order_detail')
                          .then(res => {
                              if (!res.ok) {
                                  console.error('Order detail error:', res.status, res.statusText);
                                  throw new Error('Failed to fetch order details');
                              }
                              return res.json();
                          }).then(data => {
                              if (Array.isArray(data)) {
                                  this.cart_list_detail = data.map(item => item.id);
                              } else {
                                  console.error('Order detail data is not an array:', data);
                                  this.cart_list_detail = [];
                              }
                          })
                          .catch(error => {
                              console.error('Order detail fetch error:', error);
                              this.cart_list_detail = [];
                          });
                  },
                  qr_generate(){
                      let total_payment = (this.currencyType === 'USD') ? this.totalAmount.totalPlusShip_usd : this.totalAmount.totalPlusShip_kh;

                      fetch('/qr_generate/',{
                          method : 'POST',
                          headers: { 'Content-Type': 'application/json', 'X-CSRFToken': this.getCsrfToken() },
                          body : JSON.stringify({
                              total_payment : total_payment,
                              currency_type : this.currencyType
                          })
                      })
                      .then(async res => {
                          if (!res.ok) {
                              // backend returned HTML error page
                              const html = await res.text();
                              console.error("Backend error:", html);
                              throw new Error("Django 500 error");
                          }

                          return res.json(); // safe to parse
                      })
                      .then(data => {
                          console.log("Success:", data);

                          window.location.href = data.redirect;
                      })
                      .catch(err => console.error("Error:", err));
                  },
                  add_cart_checkout(){
                      const csrfToken = this.getCsrfToken();

                      fetch('/add_cart_checkout/',{
                          method : 'POST',
                          headers : {
                              'Content-Type' : 'application/json',
                              'X-CSRFToken': csrfToken,  // Include the CSRF token
                          },
                          body : JSON.stringify({
                              'checkout' : this.getSelectedCartItems
                          })
                      }).then( res => {
                          if(!res.ok){
                              throw new Error('Error');
                          }
                          return res.json();
                      }).then(data => {
                          console.log(data);
                          window.location.href = '/checkout';
                      });
                  },
                  add_customer_info(){
                      const  csrfToken = this.getCsrfToken();
                      let total_amount_usd = this.totalAmount.totalPlusShip_usd;
                      let total_amount_khr = this.totalAmount.totalPlusShip_kh;

                      fetch('/add_customer_info/', {
                          method: 'POST',
                          headers: {
                              'Content-Type': 'application/json',
                              'X-CSRFToken': csrfToken,
                          },
                          body: JSON.stringify({
                              'phoneNumber': this.phoneNumber,
                              'email': this.email,
                              'fullName': this.fullName,
                              'address': this.address,
                              'totalAmount': this.currencyType === 'USD' ?  total_amount_usd : total_amount_khr,
                              'currencyType': this.currencyType,
                              'cart' : this.cart_list,
                              'cartDetail' : this.cart_list_detail,
                          })
                      }).then(res => {
                          if (!res.ok) {
                              throw new Error('Error = ' + res);
                          }
                          return res.json();
                      }).then(data => {
                          if (data.error) throw new Error(data.error);

                          this.orderId();
                          this.qr_generate();
                      });
                  },

                  orderId(){
                      fetch('/orderId').then(res => {
                          if (!res.ok) {
                              throw new Error('Error = ' + res);
                          }
                          return res.json();
                      }).then(data => {
                          console.log(data);
                          this.orderLastId = data.id;

                          console.log('last id = ',this.orderLastId);

                          localStorage.setItem('order_id',this.orderLastId);
                      })
                  }


              },
              mounted() {
                  console.log('Vue app mounted. CSRF Token:', csrftoken);
                  this.fetchProducts();
                  this.cart_count();
                  this.total_cart();
                  this.cart_detail();
                  this.order_detail();

                  // Start of Initialize Swiper
                  const progressCircle = document.querySelector(".autoplay-progress svg");
                  const progressContent = document.querySelector(".autoplay-progress span");

                  var swiper = new Swiper(".mySwiper", {
                      spaceBetween: 30,
                      centeredSlides: true,
                      loop:true,
                      autoplay: {
                          delay: 2500,
                          disableOnInteraction: false
                      },
                      pagination: {
                          el: ".swiper-pagination",
                          clickable: true
                      },
                      navigation: {
                          nextEl: ".swiper-button-next",
                          prevEl: ".swiper-button-prev"
                      },
                      on: {
                          autoplayTimeLeft(s, time, progress) {
                              progressCircle.style.setProperty("--progress", 1 - progress);
                              progressContent.textContent = `${Math.ceil(time / 1000)}s`;
                          }
                      }
                  });
                  // End of Initialize Swiper
              }
          };

      createApp(App).mount('#app');
    </script>
    <!-- end of vue js -->
  </body>
</html>
